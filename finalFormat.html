<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PDF Export</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            min-height: 100vh;
            background: linear-gradient(180deg, #6696ce, #00FFFF); 
            display: flex;
            justify-content: center;
            align-items: center;
            box-sizing: border-box;
        }
        .container {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
        }
        .image-card {
            border: 2px solid #ddd;
            padding: 10px;
            border-radius: 10px;
            text-align: center;
            flex: 1 1 45%;
            max-width: 45%;
            background-color: white;
        }
        .image-label {
            font-size: 14px;
            font-weight: bold;
            display: block;
            margin-bottom: 10px;
        }
        .file-input {
            display: none;
        }
        .file-button {
            padding: 10px 15px;
            background-color: #160857; 
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
        }
        .file-button:hover {
            background-color: #B2E0FF; 
        }
        .image-preview img {
            max-width: 100%;
            border-radius: 5px;
        }
        .export-button {
            margin-top: 20px;
            padding: 15px 20px;
            background-color: #000000; 
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            display: block;
            width: 100%;
            max-width: 200px;
            margin-left: auto;
            margin-right: auto;
            font-weight: bold;
        }
        .export-button:hover {
            background-color: #B2E0FF; 
        }
    </style>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.4.0/jspdf.umd.min.js"></script>
</head>
<body>
    <div id="content">
        <div class="container">
            <div class="image-card">
                <label class="image-label" for="fullGarmentPhoto">
                    <span>1. FULL PHOTO OF GARTMENT</span>
                </label>
                <input type="file" id="fullGarmentPhoto" class="file-input" accept="image/*">
                <button class="file-button" onclick="document.getElementById('fullGarmentPhoto').click()">Choose File</button>
                <div id="fullGarmentPhotoPreview" class="image-preview"></div>
            </div>
            <div class="image-card">
                <label class="image-label" for="printCloseUp">
                    <span>2. ZOOM PHOTO OF EACH PRINT LOCATION</span>
                </label>
                <input type="file" id="printCloseUp" class="file-input" accept="image/*">
                <button class="file-button" onclick="document.getElementById('printCloseUp').click()">Choose File</button>
                <div id="printCloseUpPreview" class="image-preview"></div>
            </div>
            <div class="image-card">
                <label class="image-label" for="neckLabelCloseUp">
                    <span>3. CLOSE UP NECK LABEL PRINT</span>
                </label>
                <input type="file" id="neckLabelCloseUp" class="file-input" accept="image/*">
                <button class="file-button" onclick="document.getElementById('neckLabelCloseUp').click()">Choose File</button>
                <div id="neckLabelCloseUpPreview" class="image-preview"></div>
            </div>
            <div class="image-card">
                <label class="image-label" for="cadWithNeckLabel">
                    <span>4.CAD ART INFORMATION</span>
                </label>
                <input type="file" id="cadWithNeckLabel" class="file-input" accept="image/*">
                <button class="file-button" onclick="document.getElementById('cadWithNeckLabel').click()">Choose File</button>
                <div id="cadWithNeckLabelPreview" class="image-preview"></div>
            </div>
        </div>
        <button class="export-button" onclick="exportToPDF()">Export to PDF</button>
    </div>

    <script>
        document.querySelectorAll('.file-input').forEach(input => {
            input.addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        const img = document.createElement('img');
                        img.src = e.target.result;
                        const previewDiv = document.getElementById(`${input.id}Preview`);
                        previewDiv.innerHTML = '';
                        previewDiv.appendChild(img);
                    }
                    reader.readAsDataURL(file);
                }
            });
        });

        function hideButtons() {
            document.querySelectorAll('.file-button, .export-button').forEach(button => {
                button.style.display = 'none';
            });
        }

        function showButtons() {
            document.querySelectorAll('.file-button, .export-button').forEach(button => {
                button.style.display = 'block';
            });
        }

        function exportToPDF() {
            hideButtons();

            const { jsPDF } = window.jspdf;
            const pdf = new jsPDF({
                orientation: 'landscape',
                unit: 'mm',
                format: 'a4'
            });

            const pageWidth = pdf.internal.pageSize.getWidth();
            const pageHeight = pdf.internal.pageSize.getHeight();
            const margin = 10;
            const usableWidth = pageWidth - 2 * margin;
            const usableHeight = pageHeight - 2 * margin;

            const imageCards = document.querySelectorAll('.image-card');
            const images = Array.from(imageCards).map(card => ({
                title: card.querySelector('.image-label span').textContent,
                img: card.querySelector('.image-preview img')
            })).filter(item => item.img);

            if (images.length !== 4) {
                alert('Please upload all 4 images before exporting.');
                showButtons();
                return;
            }

            // Calculate and adjust image sizes based on their aspect ratio
            images.forEach(({ title, img }, index) => {
                const aspectRatio = img.naturalWidth / img.naturalHeight;

                let imgWidth, imgHeight;
                if (index < 3) {
                    // Small images
                    imgWidth = usableWidth * 0.12;
                    imgHeight = imgWidth / aspectRatio;
                } else {
                    // Large image (CAD)
                    imgWidth = usableWidth * 0.53;
                    imgHeight = imgWidth / aspectRatio;
                }

                // Positioning
                const x = margin + (index < 3 ? 0 : usableWidth * 0.40);
                const y = margin + (index % 3) * (imgHeight + 10);

                // Add image and title to PDF
                pdf.setFontSize(10);
                pdf.text(title, x, y - 2);
                pdf.addImage(img.src, 'JPEG', x, y, imgWidth, imgHeight, '', 'FAST');
            });

            pdf.save("photo_press_check.pdf");
            showButtons();
        }
    </script>
</body>
</html>
